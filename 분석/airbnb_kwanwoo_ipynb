{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "983e2d53-2994-41b6-80bd-fad6e3db7823",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import re\n",
    "\n",
    "# 한글 폰트 설정\n",
    "plt.rcParams['font.family'] = 'Malgun Gothic'\n",
    "plt.rcParams['axes.unicode_minus'] = False ## 마이너스 부호 깨짐 방지\n",
    "\n",
    "pd.set_option('display.max_columns', None)                       # 출력할 열의 최대개수\n",
    "pd.set_option('display.max_colwidth', None)                      # 출력할 열의 너비\n",
    "# pd.reset_option('display.max_rows', None)                    # 출력할 행의 최대개수  None\n",
    "pd.set_option('display.unicode.east_asian_width', True) "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99d8cd3d-b8a8-417c-af67-89bc0fb78348",
   "metadata": {},
   "source": [
    "### 컬럼 설명\n",
    "### train_users_2.csv\n",
    "- id : 사용자 아이디\n",
    "- date_account_created: 계정 생성 날짜\n",
    "- timestamp_first_active: 첫 번째 활동의 타임스탬프입니다. 사용자가 가입하기 전에 검색할 수 있으므로 date_account_created 또는 date_first_booking보다 이전일 수 있습니다.\n",
    "- date_first_booking: 첫 예약 날짜\n",
    "- 성별\n",
    "- 나이\n",
    "- signup_method - 가입_방법\n",
    "- signup_flow: 사용자가 가입하기 위해 온 페이지\n",
    "- language: 국제 언어 기본 설정\n",
    "- affili_channel: 유료 마케팅의 종류\n",
    "- affiliate_provider: 마케팅이 이루어지는 곳. 구글, 크레이그리스트, 기타\n",
    "- first_affiliate_tracked: 가입하기 전에 사용자가 처음으로 상호작용한 마케팅은 무엇입니까?\n",
    "- signup_app - 가입_앱\n",
    "- first_device_type - 첫 번째_장치_유형\n",
    "- first_browser - 첫 번째_브라우저\n",
    "- country_destination: 예측할 대상 변수입니다.\n",
    "### session.csv - 사용자에 대한 웹 세션 로그\n",
    "- user_id: users 테이블의 'id' 컬럼과 조인됩니다.\n",
    "- action - 행동 \n",
    "- action_type\n",
    "- action_detail - 액션_디테일\n",
    "- device_type - 기기 종류\n",
    "- secs_elapsed - 초_경과 \n",
    "#### country.csv - 이 데이터세트의 목적지 국가와 해당 위치에 대한 요약 통계\n",
    "#### age_gender_bkts.csv - 사용자의 연령대, 성별, 목적지 국가에 대한 요약 통계\n",
    "#### Sample_submission.csv - 예측 제출을 위한 올바른 형식"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d828f669-3d86-465a-a8df-ef76f0d966ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>319.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>67753.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>301.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>22141.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>435.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      user_id          action action_type        action_detail  \\\n",
       "0  d1mm9tcy42          lookup         NaN                  NaN   \n",
       "1  d1mm9tcy42  search_results       click  view_search_results   \n",
       "2  d1mm9tcy42          lookup         NaN                  NaN   \n",
       "3  d1mm9tcy42  search_results       click  view_search_results   \n",
       "4  d1mm9tcy42          lookup         NaN                  NaN   \n",
       "\n",
       "       device_type  secs_elapsed  \n",
       "0  Windows Desktop         319.0  \n",
       "1  Windows Desktop       67753.0  \n",
       "2  Windows Desktop         301.0  \n",
       "3  Windows Desktop       22141.0  \n",
       "4  Windows Desktop         435.0  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## sessions\n",
    "sessions = pd.read_csv('sessions.csv')\n",
    "sessions.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "185b3803-e26b-4a1c-8cad-e980ccb40a1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "sessions['user_flow'] = sessions['action'].astype('str') + '+' + sessions['action_type'].astype('str') + '+' + sessions['action_detail'].astype('str')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "22005630-7ef9-4df1-999b-6e5350c18793",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>gxn3p5htnn</td>\n",
       "      <td>2010-06-28</td>\n",
       "      <td>20090319043255</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>facebook</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>Web</td>\n",
       "      <td>Mac Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>820tgsjxq7</td>\n",
       "      <td>2011-05-25</td>\n",
       "      <td>20090523174809</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MALE</td>\n",
       "      <td>38.0</td>\n",
       "      <td>facebook</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>seo</td>\n",
       "      <td>google</td>\n",
       "      <td>untracked</td>\n",
       "      <td>Web</td>\n",
       "      <td>Mac Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4ft3gnwmtx</td>\n",
       "      <td>2010-09-28</td>\n",
       "      <td>20090609231247</td>\n",
       "      <td>2010-08-02</td>\n",
       "      <td>FEMALE</td>\n",
       "      <td>56.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>3</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>IE</td>\n",
       "      <td>US</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bjjt8pjhuk</td>\n",
       "      <td>2011-12-05</td>\n",
       "      <td>20091031060129</td>\n",
       "      <td>2012-09-08</td>\n",
       "      <td>FEMALE</td>\n",
       "      <td>42.0</td>\n",
       "      <td>facebook</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>Web</td>\n",
       "      <td>Mac Desktop</td>\n",
       "      <td>Firefox</td>\n",
       "      <td>other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>87mebub9p4</td>\n",
       "      <td>2010-09-14</td>\n",
       "      <td>20091208061105</td>\n",
       "      <td>2010-02-18</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>41.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>Web</td>\n",
       "      <td>Mac Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>US</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      user_id date_account_created  timestamp_first_active date_first_booking  \\\n",
       "0  gxn3p5htnn           2010-06-28          20090319043255                NaN   \n",
       "1  820tgsjxq7           2011-05-25          20090523174809                NaN   \n",
       "2  4ft3gnwmtx           2010-09-28          20090609231247         2010-08-02   \n",
       "3  bjjt8pjhuk           2011-12-05          20091031060129         2012-09-08   \n",
       "4  87mebub9p4           2010-09-14          20091208061105         2010-02-18   \n",
       "\n",
       "      gender   age signup_method  signup_flow language affiliate_channel  \\\n",
       "0  -unknown-   NaN      facebook            0       en            direct   \n",
       "1       MALE  38.0      facebook            0       en               seo   \n",
       "2     FEMALE  56.0         basic            3       en            direct   \n",
       "3     FEMALE  42.0      facebook            0       en            direct   \n",
       "4  -unknown-  41.0         basic            0       en            direct   \n",
       "\n",
       "  affiliate_provider first_affiliate_tracked signup_app first_device_type  \\\n",
       "0             direct               untracked        Web       Mac Desktop   \n",
       "1             google               untracked        Web       Mac Desktop   \n",
       "2             direct               untracked        Web   Windows Desktop   \n",
       "3             direct               untracked        Web       Mac Desktop   \n",
       "4             direct               untracked        Web       Mac Desktop   \n",
       "\n",
       "  first_browser country_destination  \n",
       "0        Chrome                 NDF  \n",
       "1        Chrome                 NDF  \n",
       "2            IE                  US  \n",
       "3       Firefox               other  \n",
       "4        Chrome                  US  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## train_users_2\n",
    "train = pd.read_csv('train_users_2.csv')\n",
    "train.rename(columns={'id':'user_id'},inplace=True)\n",
    "train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "539c2079-63c0-4a27-93f1-bb80f90f4009",
   "metadata": {},
   "outputs": [],
   "source": [
    "train['timestamp_first_active'] = pd.to_datetime(train['timestamp_first_active'], format = '%Y%m%d%H%M%S').dt.strftime('%Y-%m-%d')\n",
    "train['date_account_created'] = pd.to_datetime(train['date_account_created'])\n",
    "train['date_first_booking'] = pd.to_datetime(train['date_first_booking'], errors='coerce')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "63019a06-ad49-4e92-a43f-2c2677a9aa26",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "user_id                         0\n",
       "date_account_created            0\n",
       "timestamp_first_active          0\n",
       "date_first_booking         124543\n",
       "gender                          0\n",
       "age                         87990\n",
       "signup_method                   0\n",
       "signup_flow                     0\n",
       "language                        0\n",
       "affiliate_channel               0\n",
       "affiliate_provider              0\n",
       "first_affiliate_tracked      6065\n",
       "signup_app                      0\n",
       "first_device_type               0\n",
       "first_browser                   0\n",
       "country_destination             0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8aed55fe-0109-48a0-8fdc-ef8999c0dc6a",
   "metadata": {},
   "source": [
    "### Train_Session 병합"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c6ceee6d-0184-498f-8a51-d5b8e44767ae",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "      <th>user_flow</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>319.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>67753.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>301.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>22141.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>435.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537952</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>index</td>\n",
       "      <td>data</td>\n",
       "      <td>reservations</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>245.0</td>\n",
       "      <td>index+data+reservations</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537953</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>unavailabilities</td>\n",
       "      <td>data</td>\n",
       "      <td>unavailable_dates</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>286.0</td>\n",
       "      <td>unavailabilities+data+unavailable_dates</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537954</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>notifications</td>\n",
       "      <td>submit</td>\n",
       "      <td>notifications</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>830.0</td>\n",
       "      <td>notifications+submit+notifications</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537955</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>search</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>101961.0</td>\n",
       "      <td>search+click+view_search_results</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537956</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>search</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>10863.0</td>\n",
       "      <td>search+click+view_search_results</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5537957 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            user_id            action action_type        action_detail  \\\n",
       "0        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "1        d1mm9tcy42    search_results       click  view_search_results   \n",
       "2        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "3        d1mm9tcy42    search_results       click  view_search_results   \n",
       "4        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "...             ...               ...         ...                  ...   \n",
       "5537952  nw9fwlyb5f             index        data         reservations   \n",
       "5537953  nw9fwlyb5f  unavailabilities        data    unavailable_dates   \n",
       "5537954  nw9fwlyb5f     notifications      submit        notifications   \n",
       "5537955  nw9fwlyb5f            search       click  view_search_results   \n",
       "5537956  nw9fwlyb5f            search       click  view_search_results   \n",
       "\n",
       "             device_type  secs_elapsed  \\\n",
       "0        Windows Desktop         319.0   \n",
       "1        Windows Desktop       67753.0   \n",
       "2        Windows Desktop         301.0   \n",
       "3        Windows Desktop       22141.0   \n",
       "4        Windows Desktop         435.0   \n",
       "...                  ...           ...   \n",
       "5537952           iPhone         245.0   \n",
       "5537953           iPhone         286.0   \n",
       "5537954           iPhone         830.0   \n",
       "5537955           iPhone      101961.0   \n",
       "5537956           iPhone       10863.0   \n",
       "\n",
       "                                        user_flow date_account_created  \\\n",
       "0                                  lookup+nan+nan           2014-01-01   \n",
       "1        search_results+click+view_search_results           2014-01-01   \n",
       "2                                  lookup+nan+nan           2014-01-01   \n",
       "3        search_results+click+view_search_results           2014-01-01   \n",
       "4                                  lookup+nan+nan           2014-01-01   \n",
       "...                                           ...                  ...   \n",
       "5537952                   index+data+reservations           2014-06-30   \n",
       "5537953   unavailabilities+data+unavailable_dates           2014-06-30   \n",
       "5537954        notifications+submit+notifications           2014-06-30   \n",
       "5537955          search+click+view_search_results           2014-06-30   \n",
       "5537956          search+click+view_search_results           2014-06-30   \n",
       "\n",
       "        timestamp_first_active date_first_booking     gender   age  \\\n",
       "0                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "1                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "2                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "3                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "4                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "...                        ...                ...        ...   ...   \n",
       "5537952             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537953             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537954             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537955             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537956             2014-06-30                NaT  -unknown-   NaN   \n",
       "\n",
       "        signup_method  signup_flow language affiliate_channel  \\\n",
       "0               basic            0       en     sem-non-brand   \n",
       "1               basic            0       en     sem-non-brand   \n",
       "2               basic            0       en     sem-non-brand   \n",
       "3               basic            0       en     sem-non-brand   \n",
       "4               basic            0       en     sem-non-brand   \n",
       "...               ...          ...      ...               ...   \n",
       "5537952         basic           25       en            direct   \n",
       "5537953         basic           25       en            direct   \n",
       "5537954         basic           25       en            direct   \n",
       "5537955         basic           25       en            direct   \n",
       "5537956         basic           25       en            direct   \n",
       "\n",
       "        affiliate_provider first_affiliate_tracked signup_app  \\\n",
       "0                   google                     omg        Web   \n",
       "1                   google                     omg        Web   \n",
       "2                   google                     omg        Web   \n",
       "3                   google                     omg        Web   \n",
       "4                   google                     omg        Web   \n",
       "...                    ...                     ...        ...   \n",
       "5537952             direct               untracked        iOS   \n",
       "5537953             direct               untracked        iOS   \n",
       "5537954             direct               untracked        iOS   \n",
       "5537955             direct               untracked        iOS   \n",
       "5537956             direct               untracked        iOS   \n",
       "\n",
       "        first_device_type first_browser country_destination  \n",
       "0         Windows Desktop        Chrome               other  \n",
       "1         Windows Desktop        Chrome               other  \n",
       "2         Windows Desktop        Chrome               other  \n",
       "3         Windows Desktop        Chrome               other  \n",
       "4         Windows Desktop        Chrome               other  \n",
       "...                   ...           ...                 ...  \n",
       "5537952            iPhone     -unknown-                 NDF  \n",
       "5537953            iPhone     -unknown-                 NDF  \n",
       "5537954            iPhone     -unknown-                 NDF  \n",
       "5537955            iPhone     -unknown-                 NDF  \n",
       "5537956            iPhone     -unknown-                 NDF  \n",
       "\n",
       "[5537957 rows x 22 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.merge(sessions, train, on='user_id', how='inner')\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d5bcdfbe-e9dc-4f74-ab3c-e214725d776e",
   "metadata": {},
   "source": [
    "# 예약 (1)  vs 비예약 (0) 구분"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9c4e3ee9-aeb9-43de-858f-6d326e5b721a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['binary_target'] = df['country_destination'].replace({'NDF': 0}, inplace=False)\n",
    "df.loc[df['binary_target'] != 0, 'binary_target'] = 1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f63ad22c-0329-4bce-a479-4de8fe6a46b4",
   "metadata": {},
   "source": [
    "# 가입하지 않고 예약한 자 확인\n",
    "- 로그 기록된 인원은 예약을 먼저하고 가입한 인원이 존재하지 않는다. 따라서 세션 데이터 유저는 가입 후 행동이 기록된다. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d039dd5e-e4cd-4fb5-af30-020b098d2943",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['booking_creation_delay'] = df['date_first_booking'] - df['date_account_created']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "61ce333b-fc56-4c6a-823d-dd334ca9ba70",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "      <th>user_flow</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "      <th>binary_target</th>\n",
       "      <th>booking_creation_delay</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [user_id, action, action_type, action_detail, device_type, secs_elapsed, user_flow, date_account_created, timestamp_first_active, date_first_booking, gender, age, signup_method, signup_flow, language, affiliate_channel, affiliate_provider, first_affiliate_tracked, signup_app, first_device_type, first_browser, country_destination, binary_target, booking_creation_delay]\n",
       "Index: []"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[df['booking_creation_delay'] < pd.Timedelta(0)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0faaef62-4be1-48ed-a49d-da509604284a",
   "metadata": {},
   "source": [
    "## action 계층 분석 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "f867d4d9-4cd0-4071-9ae9-7ba56af93e48",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                                    lookup+nan+nan\n",
       "1          search_results+click+view_search_results\n",
       "2                                    lookup+nan+nan\n",
       "3          search_results+click+view_search_results\n",
       "4                                    lookup+nan+nan\n",
       "                             ...                   \n",
       "5537952                     index+data+reservations\n",
       "5537953     unavailabilities+data+unavailable_dates\n",
       "5537954          notifications+submit+notifications\n",
       "5537955            search+click+view_search_results\n",
       "5537956            search+click+view_search_results\n",
       "Name: user_flow, Length: 5537957, dtype: object"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['user_flow']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "56d695eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['lookup', 'show', 'track_page_view', 'widget', 'uptodate', 'index',\n",
       "       'campaigns', 'currencies', 'localization_settings', 'update',\n",
       "       'phone_verification', 'satisfy', 'track_activity', 'check',\n",
       "       'signed_out_modal', 'disaster_action', 'similar_listings_v2'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[ (df['action_type'].isnull()) & (df['action_detail'].isnull()) ]['action'].unique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "3e8cd054",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "      <th>user_flow</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "      <th>binary_target</th>\n",
       "      <th>booking_creation_delay</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>319.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>67753.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>301.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>22141.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>435.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537952</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>index</td>\n",
       "      <td>data</td>\n",
       "      <td>reservations</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>245.0</td>\n",
       "      <td>index+data+reservations</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537953</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>unavailabilities</td>\n",
       "      <td>data</td>\n",
       "      <td>unavailable_dates</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>286.0</td>\n",
       "      <td>unavailabilities+data+unavailable_dates</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537954</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>notifications</td>\n",
       "      <td>submit</td>\n",
       "      <td>notifications</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>830.0</td>\n",
       "      <td>notifications+submit+notifications</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537955</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>search</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>101961.0</td>\n",
       "      <td>search+click+view_search_results</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537956</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>search</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>10863.0</td>\n",
       "      <td>search+click+view_search_results</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5537957 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            user_id            action action_type        action_detail  \\\n",
       "0        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "1        d1mm9tcy42    search_results       click  view_search_results   \n",
       "2        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "3        d1mm9tcy42    search_results       click  view_search_results   \n",
       "4        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "...             ...               ...         ...                  ...   \n",
       "5537952  nw9fwlyb5f             index        data         reservations   \n",
       "5537953  nw9fwlyb5f  unavailabilities        data    unavailable_dates   \n",
       "5537954  nw9fwlyb5f     notifications      submit        notifications   \n",
       "5537955  nw9fwlyb5f            search       click  view_search_results   \n",
       "5537956  nw9fwlyb5f            search       click  view_search_results   \n",
       "\n",
       "             device_type  secs_elapsed  \\\n",
       "0        Windows Desktop         319.0   \n",
       "1        Windows Desktop       67753.0   \n",
       "2        Windows Desktop         301.0   \n",
       "3        Windows Desktop       22141.0   \n",
       "4        Windows Desktop         435.0   \n",
       "...                  ...           ...   \n",
       "5537952           iPhone         245.0   \n",
       "5537953           iPhone         286.0   \n",
       "5537954           iPhone         830.0   \n",
       "5537955           iPhone      101961.0   \n",
       "5537956           iPhone       10863.0   \n",
       "\n",
       "                                        user_flow date_account_created  \\\n",
       "0                                  lookup+nan+nan           2014-01-01   \n",
       "1        search_results+click+view_search_results           2014-01-01   \n",
       "2                                  lookup+nan+nan           2014-01-01   \n",
       "3        search_results+click+view_search_results           2014-01-01   \n",
       "4                                  lookup+nan+nan           2014-01-01   \n",
       "...                                           ...                  ...   \n",
       "5537952                   index+data+reservations           2014-06-30   \n",
       "5537953   unavailabilities+data+unavailable_dates           2014-06-30   \n",
       "5537954        notifications+submit+notifications           2014-06-30   \n",
       "5537955          search+click+view_search_results           2014-06-30   \n",
       "5537956          search+click+view_search_results           2014-06-30   \n",
       "\n",
       "        timestamp_first_active date_first_booking     gender   age  \\\n",
       "0                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "1                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "2                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "3                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "4                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "...                        ...                ...        ...   ...   \n",
       "5537952             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537953             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537954             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537955             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537956             2014-06-30                NaT  -unknown-   NaN   \n",
       "\n",
       "        signup_method  signup_flow language affiliate_channel  \\\n",
       "0               basic            0       en     sem-non-brand   \n",
       "1               basic            0       en     sem-non-brand   \n",
       "2               basic            0       en     sem-non-brand   \n",
       "3               basic            0       en     sem-non-brand   \n",
       "4               basic            0       en     sem-non-brand   \n",
       "...               ...          ...      ...               ...   \n",
       "5537952         basic           25       en            direct   \n",
       "5537953         basic           25       en            direct   \n",
       "5537954         basic           25       en            direct   \n",
       "5537955         basic           25       en            direct   \n",
       "5537956         basic           25       en            direct   \n",
       "\n",
       "        affiliate_provider first_affiliate_tracked signup_app  \\\n",
       "0                   google                     omg        Web   \n",
       "1                   google                     omg        Web   \n",
       "2                   google                     omg        Web   \n",
       "3                   google                     omg        Web   \n",
       "4                   google                     omg        Web   \n",
       "...                    ...                     ...        ...   \n",
       "5537952             direct               untracked        iOS   \n",
       "5537953             direct               untracked        iOS   \n",
       "5537954             direct               untracked        iOS   \n",
       "5537955             direct               untracked        iOS   \n",
       "5537956             direct               untracked        iOS   \n",
       "\n",
       "        first_device_type first_browser country_destination binary_target  \\\n",
       "0         Windows Desktop        Chrome               other             1   \n",
       "1         Windows Desktop        Chrome               other             1   \n",
       "2         Windows Desktop        Chrome               other             1   \n",
       "3         Windows Desktop        Chrome               other             1   \n",
       "4         Windows Desktop        Chrome               other             1   \n",
       "...                   ...           ...                 ...           ...   \n",
       "5537952            iPhone     -unknown-                 NDF             0   \n",
       "5537953            iPhone     -unknown-                 NDF             0   \n",
       "5537954            iPhone     -unknown-                 NDF             0   \n",
       "5537955            iPhone     -unknown-                 NDF             0   \n",
       "5537956            iPhone     -unknown-                 NDF             0   \n",
       "\n",
       "        booking_creation_delay  \n",
       "0                       3 days  \n",
       "1                       3 days  \n",
       "2                       3 days  \n",
       "3                       3 days  \n",
       "4                       3 days  \n",
       "...                        ...  \n",
       "5537952                    NaT  \n",
       "5537953                    NaT  \n",
       "5537954                    NaT  \n",
       "5537955                    NaT  \n",
       "5537956                    NaT  \n",
       "\n",
       "[5537957 rows x 24 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "562bfed2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "user_id                          0\n",
       "action                       51532\n",
       "action_type                 619860\n",
       "action_detail               619860\n",
       "device_type                      0\n",
       "secs_elapsed                 73815\n",
       "user_flow                        0\n",
       "date_account_created             0\n",
       "timestamp_first_active           0\n",
       "date_first_booking         3057710\n",
       "gender                           0\n",
       "age                        2115437\n",
       "signup_method                    0\n",
       "signup_flow                      0\n",
       "language                         0\n",
       "affiliate_channel                0\n",
       "affiliate_provider               0\n",
       "first_affiliate_tracked       1341\n",
       "signup_app                       0\n",
       "first_device_type                0\n",
       "first_browser                    0\n",
       "country_destination              0\n",
       "binary_target                    0\n",
       "booking_creation_delay     3057710\n",
       "dtype: int64"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "dcb61ac5",
   "metadata": {},
   "outputs": [],
   "source": [
    "nan_ac = df[(df['action_type'].isnull())&(df['action_detail'].isnull())]['action'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "0d436bd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "un_ac = df[(df['action_type']=='-unknown-')&(df['action_detail']=='-unknown-')]['action'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "c18407af",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "239"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(set(nan_ac) ^ set(un_ac))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "id": "d5834e58",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'campaigns', 'currencies', 'index', 'localization_settings', 'show', 'update'}"
      ]
     },
     "execution_count": 86,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "set(nan_ac) & set(un_ac)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "2c68408a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'campaigns', 'currencies', 'index', 'localization_settings', 'show', 'update'}"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "set(nan_ac) & set(un_ac)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1696fe4b",
   "metadata": {},
   "source": [
    "## session에 유저의 인덱스가 섞여 있는지 확인"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "b3b9f5a3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "73815\n"
     ]
    }
   ],
   "source": [
    "def count_user_chages(df):\n",
    "    count=0\n",
    "    prev_user_id = None\n",
    "\n",
    "    for user_id in df['user_id']:\n",
    "        if prev_user_id is None:\n",
    "            prev_user_id = user_id\n",
    "        elif user_id != prev_user_id:\n",
    "            count+=1\n",
    "            prev_user_id = user_id\n",
    "    if prev_user_id is not None:\n",
    "        count +=1\n",
    "    return count\n",
    "\n",
    "result = count_user_chages(df)\n",
    "print(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "222b4d57",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "73815"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df['user_id'].unique())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "750f2ce2",
   "metadata": {},
   "source": [
    "## 유저별 action order 생성"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c700c29",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['action_order'] = df.groupby('user_id').cumcount() + 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "38882bf0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "      <th>user_flow</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "      <th>binary_target</th>\n",
       "      <th>booking_creation_delay</th>\n",
       "      <th>action_order</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>319.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>67753.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>301.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>22141.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>435.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537952</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>index</td>\n",
       "      <td>data</td>\n",
       "      <td>reservations</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>245.0</td>\n",
       "      <td>index+data+reservations</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537953</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>unavailabilities</td>\n",
       "      <td>data</td>\n",
       "      <td>unavailable_dates</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>286.0</td>\n",
       "      <td>unavailabilities+data+unavailable_dates</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537954</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>notifications</td>\n",
       "      <td>submit</td>\n",
       "      <td>notifications</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>830.0</td>\n",
       "      <td>notifications+submit+notifications</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537955</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>search</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>101961.0</td>\n",
       "      <td>search+click+view_search_results</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537956</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>search</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>10863.0</td>\n",
       "      <td>search+click+view_search_results</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>41</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5537957 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            user_id            action action_type        action_detail  \\\n",
       "0        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "1        d1mm9tcy42    search_results       click  view_search_results   \n",
       "2        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "3        d1mm9tcy42    search_results       click  view_search_results   \n",
       "4        d1mm9tcy42            lookup         NaN                  NaN   \n",
       "...             ...               ...         ...                  ...   \n",
       "5537952  nw9fwlyb5f             index        data         reservations   \n",
       "5537953  nw9fwlyb5f  unavailabilities        data    unavailable_dates   \n",
       "5537954  nw9fwlyb5f     notifications      submit        notifications   \n",
       "5537955  nw9fwlyb5f            search       click  view_search_results   \n",
       "5537956  nw9fwlyb5f            search       click  view_search_results   \n",
       "\n",
       "             device_type  secs_elapsed  \\\n",
       "0        Windows Desktop         319.0   \n",
       "1        Windows Desktop       67753.0   \n",
       "2        Windows Desktop         301.0   \n",
       "3        Windows Desktop       22141.0   \n",
       "4        Windows Desktop         435.0   \n",
       "...                  ...           ...   \n",
       "5537952           iPhone         245.0   \n",
       "5537953           iPhone         286.0   \n",
       "5537954           iPhone         830.0   \n",
       "5537955           iPhone      101961.0   \n",
       "5537956           iPhone       10863.0   \n",
       "\n",
       "                                        user_flow date_account_created  \\\n",
       "0                                  lookup+nan+nan           2014-01-01   \n",
       "1        search_results+click+view_search_results           2014-01-01   \n",
       "2                                  lookup+nan+nan           2014-01-01   \n",
       "3        search_results+click+view_search_results           2014-01-01   \n",
       "4                                  lookup+nan+nan           2014-01-01   \n",
       "...                                           ...                  ...   \n",
       "5537952                   index+data+reservations           2014-06-30   \n",
       "5537953   unavailabilities+data+unavailable_dates           2014-06-30   \n",
       "5537954        notifications+submit+notifications           2014-06-30   \n",
       "5537955          search+click+view_search_results           2014-06-30   \n",
       "5537956          search+click+view_search_results           2014-06-30   \n",
       "\n",
       "        timestamp_first_active date_first_booking     gender   age  \\\n",
       "0                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "1                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "2                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "3                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "4                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "...                        ...                ...        ...   ...   \n",
       "5537952             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537953             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537954             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537955             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537956             2014-06-30                NaT  -unknown-   NaN   \n",
       "\n",
       "        signup_method  signup_flow language affiliate_channel  \\\n",
       "0               basic            0       en     sem-non-brand   \n",
       "1               basic            0       en     sem-non-brand   \n",
       "2               basic            0       en     sem-non-brand   \n",
       "3               basic            0       en     sem-non-brand   \n",
       "4               basic            0       en     sem-non-brand   \n",
       "...               ...          ...      ...               ...   \n",
       "5537952         basic           25       en            direct   \n",
       "5537953         basic           25       en            direct   \n",
       "5537954         basic           25       en            direct   \n",
       "5537955         basic           25       en            direct   \n",
       "5537956         basic           25       en            direct   \n",
       "\n",
       "        affiliate_provider first_affiliate_tracked signup_app  \\\n",
       "0                   google                     omg        Web   \n",
       "1                   google                     omg        Web   \n",
       "2                   google                     omg        Web   \n",
       "3                   google                     omg        Web   \n",
       "4                   google                     omg        Web   \n",
       "...                    ...                     ...        ...   \n",
       "5537952             direct               untracked        iOS   \n",
       "5537953             direct               untracked        iOS   \n",
       "5537954             direct               untracked        iOS   \n",
       "5537955             direct               untracked        iOS   \n",
       "5537956             direct               untracked        iOS   \n",
       "\n",
       "        first_device_type first_browser country_destination binary_target  \\\n",
       "0         Windows Desktop        Chrome               other             1   \n",
       "1         Windows Desktop        Chrome               other             1   \n",
       "2         Windows Desktop        Chrome               other             1   \n",
       "3         Windows Desktop        Chrome               other             1   \n",
       "4         Windows Desktop        Chrome               other             1   \n",
       "...                   ...           ...                 ...           ...   \n",
       "5537952            iPhone     -unknown-                 NDF             0   \n",
       "5537953            iPhone     -unknown-                 NDF             0   \n",
       "5537954            iPhone     -unknown-                 NDF             0   \n",
       "5537955            iPhone     -unknown-                 NDF             0   \n",
       "5537956            iPhone     -unknown-                 NDF             0   \n",
       "\n",
       "        booking_creation_delay  action_order  \n",
       "0                       3 days             1  \n",
       "1                       3 days             2  \n",
       "2                       3 days             3  \n",
       "3                       3 days             4  \n",
       "4                       3 days             5  \n",
       "...                        ...           ...  \n",
       "5537952                    NaT            37  \n",
       "5537953                    NaT            38  \n",
       "5537954                    NaT            39  \n",
       "5537955                    NaT            40  \n",
       "5537956                    NaT            41  \n",
       "\n",
       "[5537957 rows x 25 columns]"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "71f64d60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "      <th>user_flow</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "      <th>binary_target</th>\n",
       "      <th>booking_creation_delay</th>\n",
       "      <th>action_order</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>319.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>301.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>435.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>115.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>683.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537921</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>campaigns</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>59032.0</td>\n",
       "      <td>campaigns+nan+nan</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537924</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>campaigns</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>10.0</td>\n",
       "      <td>campaigns+nan+nan</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537928</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>campaigns</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>22.0</td>\n",
       "      <td>campaigns+nan+nan</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537930</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>campaigns</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>33.0</td>\n",
       "      <td>campaigns+nan+nan</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537944</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>campaigns</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>100.0</td>\n",
       "      <td>campaigns+nan+nan</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>671392 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            user_id     action action_type action_detail      device_type  \\\n",
       "0        d1mm9tcy42     lookup         NaN           NaN  Windows Desktop   \n",
       "2        d1mm9tcy42     lookup         NaN           NaN  Windows Desktop   \n",
       "4        d1mm9tcy42     lookup         NaN           NaN  Windows Desktop   \n",
       "6        d1mm9tcy42     lookup         NaN           NaN  Windows Desktop   \n",
       "9        d1mm9tcy42     lookup         NaN           NaN  Windows Desktop   \n",
       "...             ...        ...         ...           ...              ...   \n",
       "5537921  nw9fwlyb5f  campaigns         NaN           NaN           iPhone   \n",
       "5537924  nw9fwlyb5f  campaigns         NaN           NaN           iPhone   \n",
       "5537928  nw9fwlyb5f  campaigns         NaN           NaN           iPhone   \n",
       "5537930  nw9fwlyb5f  campaigns         NaN           NaN           iPhone   \n",
       "5537944  nw9fwlyb5f  campaigns         NaN           NaN           iPhone   \n",
       "\n",
       "         secs_elapsed          user_flow date_account_created  \\\n",
       "0               319.0     lookup+nan+nan           2014-01-01   \n",
       "2               301.0     lookup+nan+nan           2014-01-01   \n",
       "4               435.0     lookup+nan+nan           2014-01-01   \n",
       "6               115.0     lookup+nan+nan           2014-01-01   \n",
       "9               683.0     lookup+nan+nan           2014-01-01   \n",
       "...               ...                ...                  ...   \n",
       "5537921       59032.0  campaigns+nan+nan           2014-06-30   \n",
       "5537924          10.0  campaigns+nan+nan           2014-06-30   \n",
       "5537928          22.0  campaigns+nan+nan           2014-06-30   \n",
       "5537930          33.0  campaigns+nan+nan           2014-06-30   \n",
       "5537944         100.0  campaigns+nan+nan           2014-06-30   \n",
       "\n",
       "        timestamp_first_active date_first_booking     gender   age  \\\n",
       "0                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "2                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "4                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "6                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "9                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "...                        ...                ...        ...   ...   \n",
       "5537921             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537924             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537928             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537930             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537944             2014-06-30                NaT  -unknown-   NaN   \n",
       "\n",
       "        signup_method  signup_flow language affiliate_channel  \\\n",
       "0               basic            0       en     sem-non-brand   \n",
       "2               basic            0       en     sem-non-brand   \n",
       "4               basic            0       en     sem-non-brand   \n",
       "6               basic            0       en     sem-non-brand   \n",
       "9               basic            0       en     sem-non-brand   \n",
       "...               ...          ...      ...               ...   \n",
       "5537921         basic           25       en            direct   \n",
       "5537924         basic           25       en            direct   \n",
       "5537928         basic           25       en            direct   \n",
       "5537930         basic           25       en            direct   \n",
       "5537944         basic           25       en            direct   \n",
       "\n",
       "        affiliate_provider first_affiliate_tracked signup_app  \\\n",
       "0                   google                     omg        Web   \n",
       "2                   google                     omg        Web   \n",
       "4                   google                     omg        Web   \n",
       "6                   google                     omg        Web   \n",
       "9                   google                     omg        Web   \n",
       "...                    ...                     ...        ...   \n",
       "5537921             direct               untracked        iOS   \n",
       "5537924             direct               untracked        iOS   \n",
       "5537928             direct               untracked        iOS   \n",
       "5537930             direct               untracked        iOS   \n",
       "5537944             direct               untracked        iOS   \n",
       "\n",
       "        first_device_type first_browser country_destination binary_target  \\\n",
       "0         Windows Desktop        Chrome               other             1   \n",
       "2         Windows Desktop        Chrome               other             1   \n",
       "4         Windows Desktop        Chrome               other             1   \n",
       "6         Windows Desktop        Chrome               other             1   \n",
       "9         Windows Desktop        Chrome               other             1   \n",
       "...                   ...           ...                 ...           ...   \n",
       "5537921            iPhone     -unknown-                 NDF             0   \n",
       "5537924            iPhone     -unknown-                 NDF             0   \n",
       "5537928            iPhone     -unknown-                 NDF             0   \n",
       "5537930            iPhone     -unknown-                 NDF             0   \n",
       "5537944            iPhone     -unknown-                 NDF             0   \n",
       "\n",
       "        booking_creation_delay  action_order  \n",
       "0                       3 days             1  \n",
       "2                       3 days             3  \n",
       "4                       3 days             5  \n",
       "6                       3 days             7  \n",
       "9                       3 days            10  \n",
       "...                        ...           ...  \n",
       "5537921                    NaT             6  \n",
       "5537924                    NaT             9  \n",
       "5537928                    NaT            13  \n",
       "5537930                    NaT            15  \n",
       "5537944                    NaT            29  \n",
       "\n",
       "[671392 rows x 25 columns]"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[df['user_flow'].str.contains('nan')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "1c832de0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>action</th>\n",
       "      <th>action_type</th>\n",
       "      <th>action_detail</th>\n",
       "      <th>device_type</th>\n",
       "      <th>secs_elapsed</th>\n",
       "      <th>user_flow</th>\n",
       "      <th>date_account_created</th>\n",
       "      <th>timestamp_first_active</th>\n",
       "      <th>date_first_booking</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>signup_method</th>\n",
       "      <th>signup_flow</th>\n",
       "      <th>language</th>\n",
       "      <th>affiliate_channel</th>\n",
       "      <th>affiliate_provider</th>\n",
       "      <th>first_affiliate_tracked</th>\n",
       "      <th>signup_app</th>\n",
       "      <th>first_device_type</th>\n",
       "      <th>first_browser</th>\n",
       "      <th>country_destination</th>\n",
       "      <th>binary_target</th>\n",
       "      <th>booking_creation_delay</th>\n",
       "      <th>action_order</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>319.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>67753.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>301.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>search_results</td>\n",
       "      <td>click</td>\n",
       "      <td>view_search_results</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>22141.0</td>\n",
       "      <td>search_results+click+view_search_results</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d1mm9tcy42</td>\n",
       "      <td>lookup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>435.0</td>\n",
       "      <td>lookup+nan+nan</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-01</td>\n",
       "      <td>2014-01-04</td>\n",
       "      <td>MALE</td>\n",
       "      <td>62.0</td>\n",
       "      <td>basic</td>\n",
       "      <td>0</td>\n",
       "      <td>en</td>\n",
       "      <td>sem-non-brand</td>\n",
       "      <td>google</td>\n",
       "      <td>omg</td>\n",
       "      <td>Web</td>\n",
       "      <td>Windows Desktop</td>\n",
       "      <td>Chrome</td>\n",
       "      <td>other</td>\n",
       "      <td>1</td>\n",
       "      <td>3 days</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537941</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>active</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>159.0</td>\n",
       "      <td>active+-unknown-+-unknown-</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537942</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>create</td>\n",
       "      <td>submit</td>\n",
       "      <td>signup</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>NaN</td>\n",
       "      <td>create+submit+signup</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537943</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>active</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>681.0</td>\n",
       "      <td>active+-unknown-+-unknown-</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537944</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>campaigns</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>100.0</td>\n",
       "      <td>campaigns+nan+nan</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5537945</th>\n",
       "      <td>nw9fwlyb5f</td>\n",
       "      <td>payment_instruments</td>\n",
       "      <td>data</td>\n",
       "      <td>payment_instruments</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>1089.0</td>\n",
       "      <td>payment_instruments+data+payment_instruments</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>2014-06-30</td>\n",
       "      <td>NaT</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NaN</td>\n",
       "      <td>basic</td>\n",
       "      <td>25</td>\n",
       "      <td>en</td>\n",
       "      <td>direct</td>\n",
       "      <td>direct</td>\n",
       "      <td>untracked</td>\n",
       "      <td>iOS</td>\n",
       "      <td>iPhone</td>\n",
       "      <td>-unknown-</td>\n",
       "      <td>NDF</td>\n",
       "      <td>0</td>\n",
       "      <td>NaT</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5537946 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            user_id               action action_type        action_detail  \\\n",
       "0        d1mm9tcy42               lookup         NaN                  NaN   \n",
       "1        d1mm9tcy42       search_results       click  view_search_results   \n",
       "2        d1mm9tcy42               lookup         NaN                  NaN   \n",
       "3        d1mm9tcy42       search_results       click  view_search_results   \n",
       "4        d1mm9tcy42               lookup         NaN                  NaN   \n",
       "...             ...                  ...         ...                  ...   \n",
       "5537941  nw9fwlyb5f               active   -unknown-            -unknown-   \n",
       "5537942  nw9fwlyb5f               create      submit               signup   \n",
       "5537943  nw9fwlyb5f               active   -unknown-            -unknown-   \n",
       "5537944  nw9fwlyb5f            campaigns         NaN                  NaN   \n",
       "5537945  nw9fwlyb5f  payment_instruments        data  payment_instruments   \n",
       "\n",
       "             device_type  secs_elapsed  \\\n",
       "0        Windows Desktop         319.0   \n",
       "1        Windows Desktop       67753.0   \n",
       "2        Windows Desktop         301.0   \n",
       "3        Windows Desktop       22141.0   \n",
       "4        Windows Desktop         435.0   \n",
       "...                  ...           ...   \n",
       "5537941           iPhone         159.0   \n",
       "5537942           iPhone           NaN   \n",
       "5537943           iPhone         681.0   \n",
       "5537944           iPhone         100.0   \n",
       "5537945           iPhone        1089.0   \n",
       "\n",
       "                                            user_flow date_account_created  \\\n",
       "0                                      lookup+nan+nan           2014-01-01   \n",
       "1            search_results+click+view_search_results           2014-01-01   \n",
       "2                                      lookup+nan+nan           2014-01-01   \n",
       "3            search_results+click+view_search_results           2014-01-01   \n",
       "4                                      lookup+nan+nan           2014-01-01   \n",
       "...                                               ...                  ...   \n",
       "5537941                    active+-unknown-+-unknown-           2014-06-30   \n",
       "5537942                          create+submit+signup           2014-06-30   \n",
       "5537943                    active+-unknown-+-unknown-           2014-06-30   \n",
       "5537944                             campaigns+nan+nan           2014-06-30   \n",
       "5537945  payment_instruments+data+payment_instruments           2014-06-30   \n",
       "\n",
       "        timestamp_first_active date_first_booking     gender   age  \\\n",
       "0                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "1                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "2                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "3                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "4                   2014-01-01         2014-01-04       MALE  62.0   \n",
       "...                        ...                ...        ...   ...   \n",
       "5537941             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537942             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537943             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537944             2014-06-30                NaT  -unknown-   NaN   \n",
       "5537945             2014-06-30                NaT  -unknown-   NaN   \n",
       "\n",
       "        signup_method  signup_flow language affiliate_channel  \\\n",
       "0               basic            0       en     sem-non-brand   \n",
       "1               basic            0       en     sem-non-brand   \n",
       "2               basic            0       en     sem-non-brand   \n",
       "3               basic            0       en     sem-non-brand   \n",
       "4               basic            0       en     sem-non-brand   \n",
       "...               ...          ...      ...               ...   \n",
       "5537941         basic           25       en            direct   \n",
       "5537942         basic           25       en            direct   \n",
       "5537943         basic           25       en            direct   \n",
       "5537944         basic           25       en            direct   \n",
       "5537945         basic           25       en            direct   \n",
       "\n",
       "        affiliate_provider first_affiliate_tracked signup_app  \\\n",
       "0                   google                     omg        Web   \n",
       "1                   google                     omg        Web   \n",
       "2                   google                     omg        Web   \n",
       "3                   google                     omg        Web   \n",
       "4                   google                     omg        Web   \n",
       "...                    ...                     ...        ...   \n",
       "5537941             direct               untracked        iOS   \n",
       "5537942             direct               untracked        iOS   \n",
       "5537943             direct               untracked        iOS   \n",
       "5537944             direct               untracked        iOS   \n",
       "5537945             direct               untracked        iOS   \n",
       "\n",
       "        first_device_type first_browser country_destination binary_target  \\\n",
       "0         Windows Desktop        Chrome               other             1   \n",
       "1         Windows Desktop        Chrome               other             1   \n",
       "2         Windows Desktop        Chrome               other             1   \n",
       "3         Windows Desktop        Chrome               other             1   \n",
       "4         Windows Desktop        Chrome               other             1   \n",
       "...                   ...           ...                 ...           ...   \n",
       "5537941            iPhone     -unknown-                 NDF             0   \n",
       "5537942            iPhone     -unknown-                 NDF             0   \n",
       "5537943            iPhone     -unknown-                 NDF             0   \n",
       "5537944            iPhone     -unknown-                 NDF             0   \n",
       "5537945            iPhone     -unknown-                 NDF             0   \n",
       "\n",
       "        booking_creation_delay  action_order  \n",
       "0                       3 days             1  \n",
       "1                       3 days             2  \n",
       "2                       3 days             3  \n",
       "3                       3 days             4  \n",
       "4                       3 days             5  \n",
       "...                        ...           ...  \n",
       "5537941                    NaT            26  \n",
       "5537942                    NaT            27  \n",
       "5537943                    NaT            28  \n",
       "5537944                    NaT            29  \n",
       "5537945                    NaT            30  \n",
       "\n",
       "[5537946 rows x 25 columns]"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nan_index = df[df['user_flow'].str.contains('nan')].index\n",
    "\n",
    "# 선택된 인덱스 주변의 행을 포함하는 새로운 데이터프레임 생성\n",
    "start_index = max(0, nan_index.min() - 1)\n",
    "end_index = min(len(df), nan_index.max() + 2)\n",
    "selected_df = df.iloc[start_index:end_index]\n",
    "\n",
    "selected_df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "988f3b93",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
      "/var/folders/zf/6h5l4dc57cj2qkp7wv1dz7zr0000gn/T/ipykernel_12683/34197254.py:3: FutureWarning: The behavior of Series.idxmax with all-NA values, or any-NA and skipna=False, is deprecated. In a future version this will raise ValueError\n",
      "  max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[88], line 3\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m# 'binary_target' = 1\u001b[39;00m\n\u001b[0;32m----> 3\u001b[0m max_wait_time_index \u001b[38;5;241m=\u001b[39m \u001b[43mdf\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mgroupby\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43muser_id\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43msecs_elapsed\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43midxmax\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m      4\u001b[0m result \u001b[38;5;241m=\u001b[39m df\u001b[38;5;241m.\u001b[39mloc[max_wait_time_index]\n\u001b[1;32m      7\u001b[0m action_counts \u001b[38;5;241m=\u001b[39m result[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124muser_flow\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mvalue_counts()\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/groupby/generic.py:1195\u001b[0m, in \u001b[0;36mSeriesGroupBy.idxmax\u001b[0;34m(self, axis, skipna)\u001b[0m\n\u001b[1;32m   1191\u001b[0m \u001b[38;5;129m@doc\u001b[39m(Series\u001b[38;5;241m.\u001b[39midxmax\u001b[38;5;241m.\u001b[39m\u001b[38;5;18m__doc__\u001b[39m)\n\u001b[1;32m   1192\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21midxmax\u001b[39m(\n\u001b[1;32m   1193\u001b[0m     \u001b[38;5;28mself\u001b[39m, axis: Axis \u001b[38;5;241m|\u001b[39m lib\u001b[38;5;241m.\u001b[39mNoDefault \u001b[38;5;241m=\u001b[39m lib\u001b[38;5;241m.\u001b[39mno_default, skipna: \u001b[38;5;28mbool\u001b[39m \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[1;32m   1194\u001b[0m ) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m Series:\n\u001b[0;32m-> 1195\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_op_via_apply\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43midxmax\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maxis\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43maxis\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mskipna\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mskipna\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1196\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m result\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mobj\u001b[38;5;241m.\u001b[39mindex\u001b[38;5;241m.\u001b[39mdtype) \u001b[38;5;28;01mif\u001b[39;00m result\u001b[38;5;241m.\u001b[39mempty \u001b[38;5;28;01melse\u001b[39;00m result\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/groupby/groupby.py:1374\u001b[0m, in \u001b[0;36mGroupBy._op_via_apply\u001b[0;34m(self, name, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1371\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_python_apply_general(curried, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_selected_obj)\n\u001b[1;32m   1373\u001b[0m is_transform \u001b[38;5;241m=\u001b[39m name \u001b[38;5;129;01min\u001b[39;00m base\u001b[38;5;241m.\u001b[39mtransformation_kernels\n\u001b[0;32m-> 1374\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_python_apply_general\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m   1375\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcurried\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1376\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_obj_with_exclusions\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1377\u001b[0m \u001b[43m    \u001b[49m\u001b[43mis_transform\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mis_transform\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1378\u001b[0m \u001b[43m    \u001b[49m\u001b[43mnot_indexed_same\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;129;43;01mnot\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mis_transform\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1379\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1381\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mgrouper\u001b[38;5;241m.\u001b[39mhas_dropped_na \u001b[38;5;129;01mand\u001b[39;00m is_transform:\n\u001b[1;32m   1382\u001b[0m     \u001b[38;5;66;03m# result will have dropped rows due to nans, fill with null\u001b[39;00m\n\u001b[1;32m   1383\u001b[0m     \u001b[38;5;66;03m# and ensure index is ordered same as the input\u001b[39;00m\n\u001b[1;32m   1384\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_set_result_index_ordered(result)\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/groupby/groupby.py:1819\u001b[0m, in \u001b[0;36mGroupBy._python_apply_general\u001b[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\u001b[0m\n\u001b[1;32m   1784\u001b[0m \u001b[38;5;129m@final\u001b[39m\n\u001b[1;32m   1785\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_python_apply_general\u001b[39m(\n\u001b[1;32m   1786\u001b[0m     \u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   1791\u001b[0m     is_agg: \u001b[38;5;28mbool\u001b[39m \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m,\n\u001b[1;32m   1792\u001b[0m ) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m NDFrameT:\n\u001b[1;32m   1793\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   1794\u001b[0m \u001b[38;5;124;03m    Apply function f in python space\u001b[39;00m\n\u001b[1;32m   1795\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   1817\u001b[0m \u001b[38;5;124;03m        data after applying f\u001b[39;00m\n\u001b[1;32m   1818\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m-> 1819\u001b[0m     values, mutated \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mgrouper\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mapply_groupwise\u001b[49m\u001b[43m(\u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdata\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43maxis\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1820\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m not_indexed_same \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m   1821\u001b[0m         not_indexed_same \u001b[38;5;241m=\u001b[39m mutated\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/groupby/ops.py:905\u001b[0m, in \u001b[0;36mBaseGrouper.apply_groupwise\u001b[0;34m(self, f, data, axis)\u001b[0m\n\u001b[1;32m    903\u001b[0m \u001b[38;5;66;03m# group might be modified\u001b[39;00m\n\u001b[1;32m    904\u001b[0m group_axes \u001b[38;5;241m=\u001b[39m group\u001b[38;5;241m.\u001b[39maxes\n\u001b[0;32m--> 905\u001b[0m res \u001b[38;5;241m=\u001b[39m \u001b[43mf\u001b[49m\u001b[43m(\u001b[49m\u001b[43mgroup\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    906\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m mutated \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m _is_indexed_like(res, group_axes, axis):\n\u001b[1;32m    907\u001b[0m     mutated \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/groupby/groupby.py:1362\u001b[0m, in \u001b[0;36mGroupBy._op_via_apply.<locals>.curried\u001b[0;34m(x)\u001b[0m\n\u001b[1;32m   1361\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mcurried\u001b[39m(x):\n\u001b[0;32m-> 1362\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mf\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/series.py:2640\u001b[0m, in \u001b[0;36mSeries.idxmax\u001b[0;34m(self, axis, skipna, *args, **kwargs)\u001b[0m\n\u001b[1;32m   2635\u001b[0m axis \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_axis_number(axis)\n\u001b[1;32m   2636\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m warnings\u001b[38;5;241m.\u001b[39mcatch_warnings():\n\u001b[1;32m   2637\u001b[0m     \u001b[38;5;66;03m# TODO(3.0): this catching/filtering can be removed\u001b[39;00m\n\u001b[1;32m   2638\u001b[0m     \u001b[38;5;66;03m# ignore warning produced by argmax since we will issue a different\u001b[39;00m\n\u001b[1;32m   2639\u001b[0m     \u001b[38;5;66;03m#  warning for argmax\u001b[39;00m\n\u001b[0;32m-> 2640\u001b[0m     \u001b[43mwarnings\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimplefilter\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mignore\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[1;32m   2641\u001b[0m     i \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39margmax(axis, skipna, \u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\u001b[1;32m   2643\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m i \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m:\n\u001b[1;32m   2644\u001b[0m     \u001b[38;5;66;03m# GH#43587 give correct NA value for Index.\u001b[39;00m\n",
      "File \u001b[0;32m/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/warnings.py:179\u001b[0m, in \u001b[0;36msimplefilter\u001b[0;34m(action, category, lineno, append)\u001b[0m\n\u001b[1;32m    175\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m action \u001b[38;5;129;01min\u001b[39;00m (\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124merror\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124malways\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdefault\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmodule\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[1;32m    176\u001b[0m                   \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124monce\u001b[39m\u001b[38;5;124m\"\u001b[39m), \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124minvalid action: \u001b[39m\u001b[38;5;132;01m%r\u001b[39;00m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;241m%\u001b[39m (action,)\n\u001b[1;32m    177\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(lineno, \u001b[38;5;28mint\u001b[39m) \u001b[38;5;129;01mand\u001b[39;00m lineno \u001b[38;5;241m>\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m0\u001b[39m, \\\n\u001b[1;32m    178\u001b[0m        \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mlineno must be an int >= 0\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m--> 179\u001b[0m \u001b[43m_add_filter\u001b[49m\u001b[43m(\u001b[49m\u001b[43maction\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcategory\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mlineno\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mappend\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mappend\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/warnings.py:181\u001b[0m, in \u001b[0;36m_add_filter\u001b[0;34m(append, *item)\u001b[0m\n\u001b[1;32m    177\u001b[0m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(lineno, \u001b[38;5;28mint\u001b[39m) \u001b[38;5;129;01mand\u001b[39;00m lineno \u001b[38;5;241m>\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m0\u001b[39m, \\\n\u001b[1;32m    178\u001b[0m            \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mlineno must be an int >= 0\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    179\u001b[0m     _add_filter(action, \u001b[38;5;28;01mNone\u001b[39;00m, category, \u001b[38;5;28;01mNone\u001b[39;00m, lineno, append\u001b[38;5;241m=\u001b[39mappend)\n\u001b[0;32m--> 181\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_add_filter\u001b[39m(\u001b[38;5;241m*\u001b[39mitem, append):\n\u001b[1;32m    182\u001b[0m     \u001b[38;5;66;03m# Remove possible duplicate filters, so new one will be placed\u001b[39;00m\n\u001b[1;32m    183\u001b[0m     \u001b[38;5;66;03m# in correct place. If append=True and duplicate exists, do nothing.\u001b[39;00m\n\u001b[1;32m    184\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m append:\n\u001b[1;32m    185\u001b[0m         \u001b[38;5;28;01mtry\u001b[39;00m:\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "# 'binary_target' = 1\n",
    "\n",
    "max_wait_time_index = df.groupby('user_id')['secs_elapsed'].idxmax()\n",
    "result = df.loc[max_wait_time_index]\n",
    "\n",
    "\n",
    "action_counts = result['user_flow'].value_counts()\n",
    "\n",
    "print(action_counts.index)\n",
    "print(action_counts.values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "c1a86618",
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'SeriesGroupBy' object has no attribute 'list'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[92], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[43mdf\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mgroupby\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43maction_type\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43maction_detail\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mlist\u001b[49m()\n",
      "File \u001b[0;32m~/myvenv/lib/python3.11/site-packages/pandas/core/groupby/groupby.py:1312\u001b[0m, in \u001b[0;36mGroupBy.__getattr__\u001b[0;34m(self, attr)\u001b[0m\n\u001b[1;32m   1309\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m attr \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mobj:\n\u001b[1;32m   1310\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m[attr]\n\u001b[0;32m-> 1312\u001b[0m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mAttributeError\u001b[39;00m(\n\u001b[1;32m   1313\u001b[0m     \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mtype\u001b[39m(\u001b[38;5;28mself\u001b[39m)\u001b[38;5;241m.\u001b[39m\u001b[38;5;18m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m object has no attribute \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mattr\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m   1314\u001b[0m )\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'SeriesGroupBy' object has no attribute 'list'"
     ]
    }
   ],
   "source": [
    "df.groupby('action_type')['action_detail'].list()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "aec71331",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "at_checkpoint\n",
      "manage_listing\n",
      "create_listing\n",
      "your_listings\n",
      "profile_references\n",
      "list_your_space\n",
      "popular_wishlists\n",
      "listing_reviews_page\n",
      "apply_coupon\n",
      "user_tax_forms\n",
      "account_payout_preferences\n",
      "guest_itinerary\n",
      "guest_receipt\n",
      "account_privacy_settings\n",
      "lookup_message_thread\n",
      "friends_wishlists\n",
      "host_guarantee\n",
      "delete_phone_numbers\n",
      "account_transaction_history\n",
      "set_password\n"
     ]
    }
   ],
   "source": [
    "x = df['action_detail'].unique().tolist()\n",
    "for i in x[40:60]:\n",
    "    print(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "id": "18b81a3f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "35"
      ]
     },
     "execution_count": 125,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[df['action_type']=='click']['user_flow'].unique()\n",
    "\n",
    "len(df[df['action_type']=='click']['user_flow'].unique())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "6727a4e9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([nan, 'click', 'data', 'view', 'submit', 'message_post',\n",
       "       '-unknown-', 'booking_request', 'partner_callback',\n",
       "       'booking_response'], dtype=object)"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['action_type'].unique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "action type: nan                action combination count = 0\n",
      "action type: click              action combination count = 35\n",
      "action type: data               action combination count = 19\n",
      "action type: view               action combination count = 52\n",
      "action type: submit             action combination count = 30\n",
      "action type: message_post       action combination count = 10\n",
      "action type: -unknown-          action combination count = 234\n",
      "action type: booking_request    action combination count = 2\n",
      "action type: partner_callback   action combination count = 1\n",
      "action type: booking_response   action combination count = 1\n"
     ]
    }
   ],
   "source": [
    "max_length = max(len(str(i)) for i in df['action_type'].unique())\n",
    "\n",
    "for i in df['action_type'].unique():\n",
    "    print('action type:',str(i).ljust(max_length),' ','action combination count =',len(df[df['action_type']==i]['user_flow'].unique()))\n",
    "\n",
    "\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5a9f6f8d",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "PythonHome_p36",
   "language": "python",
   "name": "myvenv"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
